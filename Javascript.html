<script>
	$(document).ready(function() {
    
    $('.changeItem').change(function(){
        $('#generate').click();
    });

    $(document).keypress(function (e) {
        var key = e.which;
         if(key == 13)  // the enter key code
         {
            $('#generate').click();
             return false;  
          }
    });
    
    $('#video-button').hide();
    
    var testing = false;
    $('#generate').click(function(){
        if(!testing){$("#answer").hide(); $("#show-answer").val("Show Answer");}
        $('#plot').hide();
        generate(parseInt($("#type").val()));       
     });


    $("#show-answer").click(function(){
       if($("#answer").is(":hidden") ){
          $("#answer").show();
          $("#show-answer").val("Hide Answer");
       } else{
         $("#answer").hide();
         $("#show-answer").val("Show Answer");
        }
    });
     
    if(testing){ $("#answer").show();}

	});
	function generate(type){
       
       var videoLinks = ["https://www.youtube.com/watch?v=BQJ4zYn8Z5g",
                         "https://www.youtube.com/watch?v=RGIzU3BEsrE",
                         "https://www.youtube.com/watch?v=K3DgPpVIqF4",
                         "https://www.youtube.com/watch?v=XX8zD2BTpwU",
                         "https://www.youtube.com/watch?v=fM9JsvhOBBI",
                         "https://www.youtube.com/watch?v=fGRQHaJrjkU",
                         "https://www.youtube.com/watch?v=n0LU21OnOyQ",
                         "https://www.youtube.com/watch?v=TTP6iEcOCac"];
       
       if(videoLinks[type-1].length != 0){ 
         $("#videoLink"). attr("href", videoLinks[type-1]);
         $('#video-button').show();
       }
       else{
         $('#video-button').hide();
       }
       
       
       var problem = "";
       var answer = "";
       var a,b,c,d,e,f,g,h,func;
       
       // generate different values for each 
       a = random(-10,10); 
           do{ b = random(-10,10); } while(a == b);
           do{ c = random(-10,10); } while(a == c || b == c);
           do{ d = random(-10,10); } while(a == d || b == d || c == d);
           do{ e = random(-10,10); } while(a == e || b == e || c == e || d == e);
           do{ f = random(-10,10); } while(a == f || b == f || c == f || d == f || e == f);
           do{ g = random(-10,10); } while(a == g || b == g || c == g || d == g || e == g || f == g);
           do{ h = random(-10,10); } while(a == h || b == h || c == h || d == h || e == h || f == h || g == h);
 
       $("#generated").html("");
       $("#answer").html("");
       
       switch(type) {
           // Is it a function?
           case 1: 
           switch(random(0,20)){
               // yes coordinates in set notation
               case 0:
               problem = "\\(\\{("+a+","+b+"), ("+b+","+c+"), ("+h+","+c+"), ("+e+","+f+"), ("+g+","+d+"), ("+c+","+b+"), ("+d+","+h+")\\}\\)";               
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\).";
               break;
               
               case 1:
               problem = "\\(\\{("+a+","+b+"), ("+d+","+e+"), ("+h+","+c+"), ("+e+","+f+"), ("+g+","+d+"), ("+c+","+b+"), ("+f+","+h+")\\}\\)";               
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\).";
               break;
               
               case 2:
               problem = "\\(\\{("+a+","+b+"), ("+h+","+a+"), ("+d+","+c+"), ("+e+","+f+"), ("+g+","+d+"), ("+c+","+b+"), ("+f+","+h+")\\}\\)";            
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\).";
               break;
               
               case 3:
               problem = "\\(\\{("+a+","+b+"), ("+d+","+e+"), ("+b+","+c+"), ("+e+","+f+"), ("+g+","+d+"), ("+c+","+b+"), ("+f+","+h+")\\}\\)";               
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\).";
               break;
               
               // no coordinates in set notation
               case 4:
               problem = "\\(\\{("+a+","+b+"), ("+d+","+e+"), ("+h+","+c+"), ("+e+","+f+"), ("+a+","+d+"), ("+c+","+b+"), ("+f+","+h+")\\}\\)";               
               answer = "No, this is not a function since the input of \\("+a+"\\) repeats with different outputs";
               break;
               
               case 5:
               problem = "\\(\\{("+b+","+b+"), ("+d+","+e+"), ("+a+","+c+"), ("+e+","+f+"), ("+g+","+d+"), ("+c+","+b+"), ("+a+","+h+")\\}\\)";
               answer = "No, this is not a function since the input of \\("+a+"\\) repeats with different outputs";
               break;
               
               case 6:
               problem = "\\(\\{("+b+","+b+"), ("+d+","+e+"), ("+a+","+c+"), ("+e+","+f+"), ("+g+","+d+"), ("+a+","+b+"), ("+f+","+h+")\\}\\)";               
               answer = "No, this is not a function since the input of \\("+a+"\\) repeats with different outputs";
               break;
               
               // yes table
               case 7:
               problem = "<table border='1'>"
               problem += "<tr><td>\\(x\\)</td><td>"+a+"</td><td>"+b+"</td><td>"+h+"</td><td>"+e+"</td><td>"+g+"</td><td>"+c+"</td><td>"+d+"</td></tr>";
               problem += "<tr><td>\\(y\\)</td><td>"+b+"</td><td>"+c+"</td><td>"+c+"</td><td>"+f+"</td><td>"+d+"</td><td>"+b+"</td><td>"+h+"</td></tr>";
               problem += "</table>";                              
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\).";
               break;
               
               case 8:             
               problem = "<table border='1'>"
               problem += "<tr><td>\\(x\\)</td><td>"+a+"</td><td>"+d+"</td><td>"+h+"</td><td>"+e+"</td><td>"+g+"</td><td>"+c+"</td><td>"+f+"</td></tr>";
               problem += "<tr><td>\\(y\\)</td><td>"+b+"</td><td>"+e+"</td><td>"+c+"</td><td>"+f+"</td><td>"+d+"</td><td>"+b+"</td><td>"+h+"</td></tr>";
               problem += "</table>";
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\).";
               break;
               
               case 9:
               problem = "<table border='1'>"
               problem += "<tr><td>\\(x\\)</td><td>"+a+"</td><td>"+h+"</td><td>"+d+"</td><td>"+e+"</td><td>"+g+"</td><td>"+c+"</td><td>"+f+"</td></tr>";
               problem += "<tr><td>\\(y\\)</td><td>"+b+"</td><td>"+a+"</td><td>"+c+"</td><td>"+f+"</td><td>"+d+"</td><td>"+b+"</td><td>"+h+"</td></tr>";
               problem += "</table>";
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\).";
               break;
               
               case 10:
               problem = "<table border='1'>"
               problem += "<tr><td>\\(x\\)</td><td>"+a+"</td><td>"+d+"</td><td>"+b+"</td><td>"+e+"</td><td>"+g+"</td><td>"+c+"</td><td>"+f+"</td></tr>";
               problem += "<tr><td>\\(y\\)</td><td>"+b+"</td><td>"+e+"</td><td>"+c+"</td><td>"+f+"</td><td>"+d+"</td><td>"+b+"</td><td>"+h+"</td></tr>";
               problem += "</table>";               
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\).";
               break;
               
               // no table
               case 11:
               problem = "<table border='1'>"
               problem += "<tr><td>\\(x\\)</td><td>"+a+"</td><td>"+d+"</td><td>"+h+"</td><td>"+e+"</td><td>"+a+"</td><td>"+c+"</td><td>"+f+"</td></tr>";
               problem += "<tr><td>\\(y\\)</td><td>"+b+"</td><td>"+e+"</td><td>"+c+"</td><td>"+f+"</td><td>"+d+"</td><td>"+b+"</td><td>"+h+"</td></tr>";
               problem += "</table>";               
               answer = "No, this is not a function since the input of \\("+a+"\\) repeats with different outputs";
               break;
               
               case 12:
               problem = "<table border='1'>"
               problem += "<tr><td>\\(x\\)</td><td>"+b+"</td><td>"+d+"</td><td>"+a+"</td><td>"+e+"</td><td>"+g+"</td><td>"+c+"</td><td>"+a+"</td></tr>";
               problem += "<tr><td>\\(y\\)</td><td>"+b+"</td><td>"+e+"</td><td>"+c+"</td><td>"+f+"</td><td>"+d+"</td><td>"+b+"</td><td>"+h+"</td></tr>";
               problem += "</table>";               
               answer = "No, this is not a function since the input of \\("+a+"\\) repeats with different outputs";
               break;
               
               case 13:
               problem = "<table border='1'>"
               problem += "<tr><td>\\(x\\)</td><td>"+b+"</td><td>"+d+"</td><td>"+a+"</td><td>"+e+"</td><td>"+g+"</td><td>"+a+"</td><td>"+f+"</td></tr>";
               problem += "<tr><td>\\(y\\)</td><td>"+b+"</td><td>"+e+"</td><td>"+c+"</td><td>"+f+"</td><td>"+d+"</td><td>"+b+"</td><td>"+h+"</td></tr>";
               problem += "</table>";               
               answer = "No, this is not a function since the input of \\("+a+"\\) repeats with different outputs";
               break;
               
               // graphs
               // graph of a line -> yes
               case 14:
               var line = getLinear();
               var exp = line.n/line.d+"x + "+line.b;
               draw(exp,false,"");
               $('#plot').show();
               problem = "";
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\). It passes the vertical line test.";
               break;
               
               // graph of a quadratic -> yes
               case 15:
               a = non_zero_random(-3,3);
               b = random(-5,5);
               c = random(-5,5);
               var exp = a+"x^2 + "+b+"x +"+c;
               draw(exp,false,"");
               $('#plot').show();
               problem = "";
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\). It passes the vertical line test.";
               break;
               
               // graph of a circle -> no
               case 16:
               var r;
               do{
                 a = random(-5,5);
                 b = random(-5,5);
                 r = random(2,5);               
               } while(((a+r)>10) || ((a-r)<-10) || ((b+r)>10) || ((b-r)<-10));
               var exp = "("+r+"^2 - (x-"+a+")^2)^0.5+"+b;               
               var exp2 = "-("+r+"^2 - (x-"+a+")^2)^0.5+"+b;
               drawMultiple(exp,exp2);        
               $('#plot').show();
               problem = "";
               answer = "No, this is not a function. It fails the vertical line test since at least one \\(x\\) value has multiple \\(y\\) values.";
               break;
               
               // half a circle -> yes
               case 17:
               var r;
               do{
                 a = random(-5,5);
                 b = random(-5,5);
                 r = random(2,5);               
               } while(((a+r)>10) || ((a-r)<-10) || ((b+r)>10) || ((b-r)<-10));
               var exp = "("+r+"^2 - (x-"+a+")^2)^0.5+"+b;      
               draw(exp,false,"");        
               $('#plot').show();
               problem = "";
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\). It passes the vertical line test.";
               break;
               
               // exponential -> yes
               case 18:
               a = non_zero_random(-5,5);
               b = random(1,5);
               c = random(1,9);
               var exp = a+"*("+b+"/"+c+")^x";      
               draw(exp,false,"");        
               $('#plot').show();
               problem = "";
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\). It passes the vertical line test.";
               break;
               
               // 2 exponentials -> no
               case 19:
               a = non_zero_random(-5,5);
               b = random(1,5);
               c = random(1,9);
               var exp = a+"*("+b+"/"+c+")^x"; 
               var exp2 = "-1*"+a+"*("+b+"/"+c+")^x";
               drawMultiple(exp,exp2);        
               $('#plot').show();
               problem = "";
               answer = "No, this is not a function. It fails the vertical line test since at least one \\(x\\) value has multiple \\(y\\) values.";
               break;
               
               // cubic -> yes
               case 20:
               a = non_zero_random(-3,3);
               b = random(-5,5);
               c = random(-5,5);
               var exp = a+"x^3 + "+b+"x +"+c;
               draw(exp,false,"");
               $('#plot').show();
               problem = "";
               answer = "Yes, this is a function since each input, \\(x\\), has only 1 output, \\(y\\). It passes the vertical line test.";
               break;
           
           }
           
           break;
           
           // Evaluating function values
           case 2:

           switch(random(0,4)){
              
              // given a function definition, plug in to find the output value
              case 0:
              func = generateForEval();
              problem = "If \\(f(x) = "+func.functionPrinted+"\\), find \\(f("+func.input1+")\\)";
              answer = "\\(f("+func.input1+") = "+func.answer1+"\\)";
              break;

              // given a table, find the output for the right input
              case 1: case 2: 
              var funcTable = getFuncTable();
              problem = "Given \\(f(x)\\) below, find \\(f("+funcTable.inputVal+")\\)";
              problem += funcTable.printTable;
              answer = "\\(f("+funcTable.inputVal+") = "+funcTable.outputVal+"\\)";
              break;

              // given a table, find the input for the right output
              case 3: case 4:
              var funcTable = getFuncTable();
              problem = "Given \\(f(x)\\) below, find \\(x\\) when \\(f(x)="+funcTable.outputVal+"\\)";
              problem += funcTable.printTable;
              answer = "\\(x = "+funcTable.inputVal+"\\) since \\(f("+funcTable.inputVal+") = "+funcTable.outputVal+"\\)";
              break;
           }

           break;
		  
           // Domain and Range
           case 3: 

           switch(random(0,1)){
            // curve
            case 0:
            var cur = generateFuncCurve();
            drawCurve(cur);
            //createInterval(min,incMin,max,incMax,variable){
            var domain = createInterval(cur.xmin,true,cur.xmax,true,"x");
            var range = createInterval(cur.ymin,true,cur.ymax,true,"y");
            answer = `Domain: \\(${domain}\\), Range: \\(${range}\\)`;
            break;
            
            // function
            case 1:
            func = generateFunction();
            draw(func.expression,true,func.vertex);
            problem += "\\(g(x) = "+func.functionPrinted+"\\)";
            answer = "Domain: \\("+func.domain+"\\), Range: \\("+func.range+"\\)<br>";
            break;

           }
           
           $('#plot').show();
           problem = "Determine the domain and range for the function <br>";
          
           break;
		   
           // Increasing and Decreasing
           case 4:
           func = generateFunction();
           draw(func.expression,true,func.vertex);
           $('#plot').show();
           problem = "Determine the increasing and decreasing intervals for the function <br>";
           problem += "\\(g(x) = "+func.functionPrinted+"\\)";
           answer = "Increasing: \\("+func.increasing+"\\), Decreasing: \\("+func.decreasing+"\\)";
          
           break;
           
           // Transformations
           case 5:
           func = generateFunction();
           draw(func.expression,true,func.vertex);
           $('#plot').show();
           problem = "Determine the parent function and transformations for the function <br>";
           problem += "\\(g(x) = "+func.functionPrinted+"\\)";
           answer = "Parent function: \\(f(x)="+func.parent+"\\)<br>";
           answer += "Transformations: "+func.transforms+"<br>";
           
           break;
           
           // Rate of Change
           case 6:
           func = generateForEval(); 
           problem = "Determine the rate of change of \\(f(x) = "+func.functionPrinted+"\\) over the interval \\("+func.input1+"\\leq x \\leq "+func.input2+"\\)";
           answer = "\\(f("+func.input1+") = "+func.answer1+"\\), ";
           answer += "\\(f("+func.input2+") = "+func.answer2+"\\)<br>";
           answer += "Rate of Change = \\(\\frac{"+func.answer2+" - "+func.answer1+"}{"+func.input2+" - "+func.input1+"}=\\frac{"+(func.answer2-func.answer1)+"}{"+(func.input2-func.input1)+"} = ";
           answer += simplifyFrac((func.answer2-func.answer1),(func.input2-func.input1))+"\\)";
           break;
           
           // All Key Features
           case 7:
           func = generateFunction();
           draw(func.expression,true,func.vertex);
           $('#plot').show();
           problem = "Determine the parent function, transformations, domain, range, and increasing and decreasing intervals for the function <br>";
           problem += "\\(g(x) = "+func.functionPrinted+"\\)";
           answer = "Parent function: \\(f(x)="+func.parent+"\\)<br>";
           answer += "Transformation(s): "+func.transforms+"<br>";
           answer += "Domain: \\("+func.domain+"\\), Range: \\("+func.range+"\\)<br>";
           answer += "Increasing: \\("+func.increasing+"\\), Decreasing: \\("+func.decreasing+"\\)";
          
           break;

           // Interval & Inequality Notation
           case 8:
           var not = generateNotation();

           switch(random(0,1)){
             
             // interval to inequality
             case 0:
             problem = "Convert "+not.interval+" to inequality notation";
             answer = not.inequality;
             break;
             
             // inequality to interval
             case 1:
             problem = "Convert "+not.inequality+" to interval notation";
             answer = not.interval;
             break;

           }
          
           break;
       }
            
       $("#generated").html(problem);
       $("#answer").html(answer);
       renderMathInElement(document.body);
       //MathJax.Hub.queue.Push(["Typeset",MathJax.Hub,"generated"]);
       //MathJax.Hub.queue.Push(["Typeset",MathJax.Hub,"answer"]);
	}
	
    function generateNotation(){

        var min = random(-100,100);
        var max = random(1,100)+min;

        var leftInterval, rightInterval, leftIneq, rightIneq, letter, domainRangeWord;

        // open on left, else closed
        if(random(0,1) == 0){ leftInterval = "("; leftIneq = " < "; } else { leftInterval = "["; leftIneq = " \\leq "; }

        // open on right, else closed
        if(random(0,1) == 0){ rightInterval = ")"; rightIneq = " < "; } else { rightInterval = "]"; rightIneq = " \\leq ";}
        
        // left is neg infinity
        if(random(0,5) == 0){ min = "-\\infty "; leftInterval = "("; leftIneq = "<";}

        // right is infinity
        if(random(0,5) == 0){ max = "\\infty "; rightInterval = ")"; rightIneq = "<";}

        min = min.toString();
        max = max.toString();

        // domain or range
        if(random(0,1) == 0){ letter = " x "; domainRangeWord = "Domain";} else{ letter = " y "; domainRangeWord = "Range";}

        var intervalNotation = domainRangeWord+": \\("+leftInterval+min+" , "+max+rightInterval+"\\)";
        var inequalityNotation = "\\("+min+leftIneq+letter+rightIneq+max+"\\)";

        return {interval: intervalNotation, inequality: inequalityNotation};

    }


    function myRandomInts(quantity, max){
      const arr = [];
      while(arr.length < quantity){
        var candidateInt = random(-1*max, max);
        if(arr.indexOf(candidateInt) === -1){ arr.push(candidateInt); }
  }
return(arr)
}

    function shuffle(array) {
  let currentIndex = array.length,  randomIndex;

  // While there remain elements to shuffle...
  while (currentIndex != 0) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;

    // And swap it with the current element.
    [array[currentIndex], array[randomIndex]] = [
      array[randomIndex], array[currentIndex]];
  }

  return array;
}

    // generates a function table
    function getFuncTable(){
      var tableSize = random(6,10);
      var randomVals = myRandomInts(tableSize,50);
      var xVals = [...randomVals];
      var yVals = shuffle(randomVals);

       var xstring = ""; 
       var ystring = "";
           
       var output = "<table border='1'>";
       output += "<tr><td>\\(x\\)</td>";
           
       for(var i = 0; i < tableSize; i++){
          xstring += "<td>"+xVals[i]+"</td>";
          ystring += "<td>"+yVals[i]+"</td>";
           
       }
           
       output += xstring+"</tr><tr><td>\\(f(x)\\)</td>"+ystring+"</tr>";
       output += "</table>";
       
       var randomIndex = random(0, tableSize-1);

       return {printTable:output, inputVal:xVals[randomIndex],outputVal:yVals[randomIndex]};

    }

    // generate function curve
    function generateFuncCurve(){
      
      var xVals = [random(-10,-7),random(-5,-4),random(4,5),random(7,10)];
      var yVals = [];

      switch(random(0,1)){
          // start low
          case 0:
          yVals[0] = random(-10,-6);
          yVals[1] = random(yVals[0]+5,10);
          yVals[2] = random(yVals[1]-5,-10);
          yVals[3] = random(yVals[2]+5,10);
          break;

          // start high
          case 1:
          yVals[0] = random(6,10);
          yVals[1] = random(yVals[0]-5,-10);
          yVals[2] = random(yVals[1]+5,10);
          yVals[3] = random(yVals[2]-5,-10);
          break;

      } 
      var func1= quinticWithExtremaPretty(xVals,yVals);
      var maxAndMin = getMaxAndMin(func1,xVals[0],xVals[3]);

       do{
          func1 = quinticWithExtremaPretty(xVals,yVals);
      } while(maxAndMin.min < -10 || maxAndMin.max > 10); // make sure it stays on grid 

      return {exp: func1, xCoords:xVals, yCoords: yVals, xmin: xVals[0], xmax: xVals[3],ymin: maxAndMin.min, ymax: maxAndMin.max};

    }

    // generates a function using transformations 
    function generateFunction(){
    
       var output = {functionPrinted:"", parent: "", domain: "", range: "", increasing: "", decreasing: "", transforms: "",expression:"",vertex:[]};
       var func = "";
       var parent = "";
       var trans = "";
       var domain = "";
       var range = "";
       var inc = "";
       var dec = "";
       var exp = "";
       var vertexCoords = [0,0];

      var refl = ""; // reflection over x-axis
      switch(random(0,1)){ 
          case 0: 
             refl = "yes";
             trans += "Reflection over the \\(x\\)-axis;";
             func += "-";
             exp += "-";
          break; 
          case 1: refl = 0; break;
      }
      
      var vS = ""; // vertical strech
      switch(random(0,1)){ 
          case 0: 
             vS = non_zero_random(2,6); 
             trans += " Vertical stretch times "+vS+";";
             func += vS;
             exp += vS+"*";
          break; 
          case 1: vS = "none"; break;
      }
      
      var hT = ""; // horizontal transformation
       switch(random(0,1)){ 
          case 0: 
             hT = non_zero_random(-5,5); 
             vertexCoords[0] = hT*-1;
             trans += " Horizontal shift ";
          if(hT > 0){ trans += "left ";} else { trans += "right ";}
          trans += Math.abs(hT)+" units; ";
          break; 
          case 1: hT = 0; break;
      }
       
       var vT = ""; // vertical transformation
       switch(random(0,1)){ 
          case 0: 
             vT = non_zero_random(-5,5);
             vertexCoords[1] = vT; 
             trans += " Vertical shift ";
          if(vT > 0){ trans += "up ";} else { trans += "down ";}
          trans += Math.abs(vT)+" units; ";
          break; 
          case 1: vT = 0; break;
      }
      // leave linear case 5 out and cubed root case 4 out
      switch(random(0,3)){
         case 0: // abs value
         parent = "|x|";
  
         if(hT != 0){ 
            func += "|x + "+hT+"|";
            exp += `abs(x+${hT})`;
            if(refl == 0){
               inc = createInterval((-1*hT),false,"\\infty",false,"x");
               dec = createInterval("-\\infty",false,(-1*hT),false,"x");
            }
            else{
               dec = createInterval((-1*hT),false,"\\infty",false,"x");
               inc = createInterval("-\\infty",false,(-1*hT),false,"x");
            }
         }
         else{
            func += "|x|";
            exp += "abs(x)";
            if(refl == 0){
               inc = createInterval("0",false,"\\infty",false,"x");
               dec = createInterval("-\\infty",false,"0",false,"x");
            }
            else{
               dec = createInterval("0",false,"\\infty",false,"x");
               inc = createInterval("-\\infty",false,"0",false,"x");
            }
         }
          
         domain = createInterval("-\\infty",false,"\\infty",false,"x");

         if(vT != 0){ 
            func += " + "+vT;
            exp += `+${vT}`;
         }
         
         if(refl == 0){    
          range = createInterval(vT,true,"\\infty",false,"y");
         }
         else{ 
          range = createInterval("-\\infty",false,vT,true,"y");
         }

         break;  // end absolute value

         case 1: // quadratic
         parent = "x^2";
         
         if(hT != 0){ 
            func += "(x + "+hT+")^2";
            exp += `(x+${hT})^2`;
            if(refl == 0){
               inc = createInterval((-1*hT),false,"\\infty",false,"x");
               dec = createInterval("-\\infty",false,(-1*hT),false,"x");
            }
            else{
               dec = createInterval((-1*hT),false,"\\infty",false,"x");
               inc = createInterval("-\\infty",false,(-1*hT),false,"x");
            }
         }
         else{
            func += "x^2";
            exp += "x^2";
            if(refl == 0){
               inc = createInterval("0",false,"\\infty",false,"x");
               dec = createInterval("-\\infty",false,"0",false,"x");
            }
            else{
               dec = createInterval("0",false,"\\infty",false,"x");
               inc = createInterval("-\\infty",false,"0",false,"x");
            }
         }
          
         domain = createInterval("-\\infty",false,"\\infty",false,"x");

         if(vT != 0){   func += " + "+vT; exp += `+${vT}`; }
         
         if(refl == 0){   
          range = createInterval(vT,true,"\\infty",false,"y");
         }
         else{ 
          range = createInterval("-\\infty",false,vT,true,"y");
         }
         break; // end quadratic
         
         case 2: // cubic
         parent = "x^3";
         if(hT != 0){   func += "(x + "+hT+")^3"; exp += `(x+${hT})^3`; }
         else{  func += "x^3";  exp += "x^3"; }
         
         if(refl == 0){
               inc = createInterval("-\\infty",false,"\\infty",false,"x");
               dec = "\\)Never\\(";
            }
            else{
               dec = createInterval("-\\infty",false,"\\infty",false,"x");
               inc = "\\)Never\\(";
            }
         
         domain = createInterval("-\\infty",false,"\\infty",false,"x");

         if(vT != 0){   func += " + "+vT;  exp += `+${vT}`;  }
         
         range = createInterval("-\\infty",false,"\\infty",false,"y");
         break; // end cubic
         
         case 3: // square root
         parent = "\\sqrt{x}";
         
         if(hT != 0){   func += "\\sqrt{x + "+hT+"}"; exp += `sqrt(x+${hT})`; }
         else{  func += "\\sqrt{x}";  exp += "sqrt(x)"; }
         
         if(refl == 0){
               inc = createInterval((-1*hT),false,"\\infty",false,"x");
               dec = "\\)Never\\(";
            }
            else{
               dec = createInterval((-1*hT),false,"\\infty",false,"x");
               inc = "\\)Never\\(";
            }
         
         domain = createInterval((-1*hT),true,"\\infty",false,"x");
         
         if(vT != 0){   func += " + "+vT; exp += `+${vT}`; }
         
         if(refl == 0){      
          range = createInterval(vT,true,"\\infty",false,"y");
         }
         else{ 
          range = createInterval("-\\infty",false,vT,true,"y");
         }

         break; // end square root
         
         /*
         case 4: // cubed root
         parent = "\\sqrt[3]{x}";
         
         if(hT != 0){   func += "\\sqrt[3]{x + "+hT+"}";  }
         else{  func += "\\sqrt[3]{x}"; }
         
         if(refl == 0){
               inc = "(-\\infty , \\infty)";
               dec = "\\)Never\\(";
            }
            else{
               dec = "(-\\infty , \\infty)";
               inc = "\\)Never\\(";
            }
          
         domain = "(-\\infty , \\infty)";
         
         if(vT != 0){   func += " + "+vT;}
         
         range = "(-\\infty , \\infty)";

         break; // end cubed root

         case 5: // linear
         parent = "x";
         if(hT != 0){   func += "(x + "+hT+")"; }
         else{  func += "x";  }
         
         if(refl == 0){
               inc = "(-\\infty , \\infty)";
               dec = "\\)Never\\(";
            }
            else{
               dec = "(-\\infty , \\infty)";
               inc = "\\)Never\\(";
            }
          
         domain = "(-\\infty , \\infty)";
         if(vT != 0){   func += " + "+vT;}
         range = "(-\\infty , \\infty)";
         
         
         break; // end linear
         */
      
      }
      output.parent = parent;
      output.domain = domain;
      output.range = range;
      output.increasing = inc;
      output.decreasing = dec;
      output.functionPrinted = doublesigns(func);
      if(trans == ""){ trans = "None"; }
      output.transforms = trans;
      output.expression = exp;
      output.vertex = vertexCoords;
      
      return output;
    }
    
    // generates function with input and answer
    function generateForEval(){
    
        var output = {functionPrinted:"", input1:"", answer1:"", input2:"", answer2:""};
        var x1 = random(-10,10);
        var x2 = random(1,10)+x1; 
        
        var fun = "";
        var answer1 = "";
        var answer2 = "";
        
        output.input1 = x1;
        output.input2 = x2;
                
        var num1,num2,num3,num4,num5;
           num1 = non_zero_random(-5,5);
           num2 = non_zero_random(-5,5);
           num3 = non_zero_random(-5,5);
           num4 = non_zero_random(-5,5);
           num5 = non_zero_random(-5,5);
        
        switch(random(0,8)){

           case 0: 
           fun = num1+"x^2 + "+num2+"x + "+num3;
           answer1 = num1*(x1**2)+num2*x1+num3;
           answer2 = num1*(x2**2)+num2*x2+num3;
           
           break;
           
           case 1:
           fun = num4+"x^3 + "+num1+"x^2 + "+num2+"x + "+num3;
           answer1 = num4*(x1**3)+num1*(x1**2)+num2*x1+num3;
           answer2 = num4*(x2**3)+num1*(x2**2)+num2*x2+num3;
           
           break;
        
           case 2:
           fun = num1+"|x| + "+num2;
           answer1 = num1*Math.abs(x1)+num2;
           answer2 = num1*Math.abs(x2)+num2;
           
           break;
           
           case 3:
           fun = num1+"|x + "+num3+"| + "+num2;
           answer1 = num1*Math.abs(x1+num3)+num2;
           answer2 = num1*Math.abs(x2+num3)+num2;

           break;

           case 4:  case 5: case 6: case 7: case 8:
           fun = num1+"x + "+num2;
           answer1 = num1*(x1)+num2;
           answer2 = num1*(x2)+num2;
           
           break;

        }
        
        // takes care of weird rounding errors
        output.functionPrinted = doublesigns(fun);
        output.answer1 = Math.round(answer1*100000)/100000;
        output.answer2 = Math.round(answer2*100000)/100000;
        
        return output;
    
    }

    
    // removes all double signs
    function doublesigns(string){
       return string.replaceAll("-+", "-").replaceAll("- +", "-").replaceAll("+ -", "-").replaceAll("- -", "+").replaceAll("+-", "-").replaceAll("-- ", "+");
    }
    
    String.prototype.replaceAll = function(searchStr, replaceStr) {
	   var str = this;
       // no match exists in string?
       if(str.indexOf(searchStr) === -1) {
          // return string
          return str;
       }
      // replace and remove first match, and do another recursirve search/replace
       return (str.replace(searchStr, replaceStr)).replaceAll(searchStr, replaceStr);
    }
    
    // random integer between and including min and max
	function random(min, max) {
         return Math.floor(Math.random() * (max - min + 1) ) + min;
    } 
    
    // random non-zero integer bewteen min and max
    function non_zero_random(min, max) {
         var output;
         do{output = Math.floor(Math.random() * (max - min + 1) ) + min;} while (output === 0);  
         return output;
    } 
    
    function gcd(x, y) {
       if ((typeof x !== 'number') || (typeof y !== 'number')) 
       return false;
         x = Math.abs(x);
         y = Math.abs(y);
      while(y) {
        var t = y;
        y = x % y;
        x = t;
      }
      return x;
     }
    
    
    // simplify fraction
    function simplifyFrac(num, denom){
         
     // format the negative better so that it isn't in a fraction
     var neg = "";
     if((num/denom) < 0){
        
        num = Math.abs(num);
        denom = Math.abs(denom);
        neg = "-";
        
     }
       // if integer, return integer
       if((num % denom) === 0){
       
         return neg+num/denom;
         
       }
       // otherwise, return fraction in simplest form
       else{
            var g = gcd(num,denom);
            return neg+"\\frac{"+(num/g)+"}{"+(denom/g)+"}";
        }
      }
 
    // helper function for graphing to produce a line with a viable y-intercept and slope that'll fit in 10 by 10
    function getLinear(){
       var found = false;
       var num, den, slope, yInt;
       
       do{
           // generate values to be tested
           yInt = random(-9,9); 
           num = non_zero_random(-10,10);
           den = non_zero_random(-5,5);
           
           // test to see if values produce another coordinate in 10 by 10 
           for(var i = -9; i < 9; i++){
           
              var yVal = num/den*i+yInt;
              
              if(yVal > -10 && yVal < 10){
                 
                 found = true;
              
              }
            
           }
       }
       while(!found);
       
       return {n:num, d:den, b:yInt};
    } 
    
 
    // function that draws the graph between -10 and 10
    function draw(expression,showDots,vertex) {
    try {
      // compile the expression once
      var expr = math.compile(expression);
      var incr = 0.1; 
      if(expression.indexOf("sqrt") !== -1){ incr = 0.001; }

      // evaluate the expression repeatedly for different values of x
      var xValues = math.range(-11, 11, incr).toArray();

      for(var i = 0; i < xValues.length; i ++){ 
          xValues[i] = Math.round(xValues[i]*100)/100;
      }

      const yValues = xValues.map(function (x) {
        return expr.eval({x: x});
      })

      if(vertex != ""){
      var vertexTrace = {
        x: [vertex[0]],
        y: [vertex[1]],
        type: 'scatter',
        mode: 'markers',
        marker: {
          color: '#3F4591',
          size: 6
        },
        hoverinfo:'none'
      };
      }
      
      if(showDots){
      
         var xValues2 = [];
         var yValues2 = []
         for(var i = 0; i < xValues.length; i ++){      
               // creates the "pretty points" to graph points at integer y-values
               if(Number.isInteger(yValues[i]) && Number.isInteger(xValues[i])){        
                  xValues2.push(xValues[i]);
                  yValues2.push(yValues[i]);        
               }          
         }    
         
      // render the "pretty points" using plotly
      var trace2 = {
        x: xValues2,
        y: yValues2,
        type: 'scatter',
        mode: 'markers',
        marker: {
          color: '#3F4591',
          size: 6
        },
        hoverinfo:'none'
      };
      }
      
      
      // render the line using plotly
      var trace1 = {
        x: xValues,
        y: yValues,
        type: 'scatter',
        mode: 'lines',        
        line: {
          color: '#3F4591',
          width: 2
        },
        name:"",
      };
   
      var axis_template ={
        showgrid: true,
        zeroline: true,
        nticks: 23,
        range: [-11,11], 
        gridcolor: '#bdbdbd', //grid color
        gridwidth: 1.2, //grid width
        zerolinecolor: 'black', // axes color
        zerolinewidth: 1.5, // axes widths
        showticklabels:false
      };        
      
      var axisMarkers =   {
        x: [-0.25,10.75],
        y: [10.75,-0.25],
        mode: 'text',
        text:["y","x"],
        textposition:["left","bottom"],
        textfont: {
          size:18,
        },
        hoverinfo:'none'
      };

      // make grid smaller for mobile
      var gridsize;
      var indent;
      // gridsize= Math.min(.95*window.innerWidth,550);
      
      if(window.innerWidth > 601){
         gridsize = 550;
         indent = 20;
      }else{
         gridsize = 350;
         indent = 0;
      }
      
      var xTickMarkLabels =   {
        x: [-10.1,-9.1,-8.1,-7.1,-6.1,-5.1,-4.1,-3.1,-2.1,-1.1,0,1,2,3,4,5,6,7,8,9,10],
        y: [-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1],
        mode: 'text',
        text:[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10],
        textposition:"bottom",
        textfont: {
          size:13,
        },
        hoverinfo:'none'
      };   
      
      var yTickMarkLabels =   {
        y: [-10.1,-9.1,-8.1,-7.1,-6.1,-5.1,-4.1,-3.1,-2.1,-1.1,0,1,2,3,4,5,6,7,8,9,10],
        x: [-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1],
        mode: 'text',
        text:[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10],
        textposition:"left",
        textfont: {
          size:13,
        },
        hoverinfo:'none'
      };
      
      var layout = {
        xaxis:axis_template,
        yaxis:axis_template,
        showlegend: false,
        width: gridsize,
        height: gridsize,
        hovermode: 'closest',   
        font:{size: 18},
        margin: {l: indent,  r: 30, t: 20}
      };
      
      layout.annotations= [
      {
         x: 0,
         y: 11,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: 0,
         ay: 35
       },
       {
         x: 0,
         y: -11,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: 0,
         ay: -35
       },
       {
         x: 11,
         y: 0,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: -35,
         ay: 0
       },
       {
         x: -11,
         y: 0,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: 35,
         ay: 0
       }

     ];
     var data = [trace1,xTickMarkLabels,yTickMarkLabels,axisMarkers];
      if(vertex != ""){ data.push(vertexTrace); }
      if(showDots){ data.push(trace2); }
         
      Plotly.newPlot('plot', data, layout,{displayModeBar: false});
    }
    catch (err) {
      console.error(err)
      alert(err)
    }
  }

  // function that draws the graph between -10 and 10
    function drawCurve(curve) {
    try {
      
      // compile the expression once
      var expr = math.compile(curve.exp);
      // evaluate the expression repeatedly for different values of x
      var xValues = math.range(curve.xCoords[0], curve.xCoords[curve.xCoords.length-1], 0.1).toArray();
      
      for(var i = 0; i < xValues.length; i ++){ 
          xValues[i] = Math.round(xValues[i]*100)/100;
      }
      
      const yValues = xValues.map(function (x) {
        return expr.eval({x: x});
      });
      
      // render the graph using plotly
      var trace1 = {
        x: xValues,
        y: yValues,
        type: 'scatter',
        mode: 'lines',        
        line: {
          color: '#3F4591',
          width: 2
        },
        name:"",
      };

      // render the "pretty points" using plotly
      var trace2 = {
        x: curve.xCoords,
        y: curve.yCoords,
        type: 'scatter',
        mode: 'markers',
        marker: {
          color: '#3F4591',
          size: 6
        },
        hoverinfo:'none'
      };
   
      var axis_template ={
        showgrid: true,
        zeroline: true,
        nticks: 23,
        range: [-11,11], 
        gridcolor: '#bdbdbd', //grid color
        gridwidth: 1.2, //grid width
        zerolinecolor: 'black', // axes color
        zerolinewidth: 1.5, // axes widths
        showticklabels:false
      };        
      
      var axisMarkers =   {
        x: [-0.25,10.75],
        y: [10.75,-0.25],
        mode: 'text',
        text:["y","x"],
        textposition:["left","bottom"],
        textfont: {
          size:18,
        },
        hoverinfo:'none'
      };

      // make grid smaller for mobile
      var gridsize;
      var indent;
      // gridsize= Math.min(.95*window.innerWidth,550);
      
      if(window.innerWidth > 601){
         gridsize = 550;
         indent = 20;
      }else{
         gridsize = 350;
         indent = 0;
      }
      
      var xTickMarkLabels =   {
        x: [-10.1,-9.1,-8.1,-7.1,-6.1,-5.1,-4.1,-3.1,-2.1,-1.1,0,1,2,3,4,5,6,7,8,9,10],
        y: [-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1],
        mode: 'text',
        text:[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10],
        textposition:"bottom",
        textfont: {
          size:13,
        },
        hoverinfo:'none'
      };   
      
      var yTickMarkLabels =   {
        y: [-10.1,-9.1,-8.1,-7.1,-6.1,-5.1,-4.1,-3.1,-2.1,-1.1,0,1,2,3,4,5,6,7,8,9,10],
        x: [-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1],
        mode: 'text',
        text:[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10],
        textposition:"left",
        textfont: {
          size:13,
        },
        hoverinfo:'none'
      };
      
      var layout = {
        xaxis:axis_template,
        yaxis:axis_template,
        showlegend: false,
        width: gridsize,
        height: gridsize,
        hovermode: 'closest',   
        font:{size: 18},
        margin: {l: indent,  r: 30, t: 20}
      };
      
      layout.annotations= [
      {
         x: 0,
         y: 11,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: 0,
         ay: 35
       },
       {
         x: 0,
         y: -11,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: 0,
         ay: -35
       },
       {
         x: 11,
         y: 0,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: -35,
         ay: 0
       },
       {
         x: -11,
         y: 0,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: 35,
         ay: 0
       }

     ];
      
      var data = [trace1,trace2,xTickMarkLabels,yTickMarkLabels,axisMarkers];
      Plotly.newPlot('plot', data, layout,{displayModeBar: false});
    }
    catch (err) {
      console.error(err)
      alert(err)
    }
  }
  
  // function that draws the graph between -10 and 10
    function drawMultiple(expression1, expression2) {
    try {
      // compile the first expression
      var expr = math.compile(expression1)

      // evaluate the expression repeatedly for different values of x
      var xValues = math.range(-11, 11, 0.01).toArray();
      
      // need to round these because of number types.  The values in the array weren't the exact decimals needed
      for (var i = 0; i < xValues.length; i ++){         
         xValues[i] = Math.round(xValues[i]*100)/100;         
      }
      
      const yValues = xValues.map(function (x) {
        if(isNumber(expr.eval({x: x}))){
        return expr.eval({x: x});
        }
        else{ return ""; };
      })       
      // render the graph using plotly
      var trace1 = {
        x: xValues,
        y: yValues,
        type: 'scatter',
        mode: 'lines',        
        line: {
          color: '#3F4591',
          width: 2
        },
        name:"",
      };
      
      // compile the second expression
      var expr2 = math.compile(expression2)

      // ok to use the same x values for both functions
      const yValues2 = xValues.map(function (x) {
        if(isNumber(expr2.eval({x: x}))){
        return expr2.eval({x: x});
        }
        else{ return ""; };
      })
      
      // render the second graph using plotly
      var trace2 = {
        x: xValues,
        y: yValues2,
        type: 'scatter',
        mode: 'lines',        
        line: {
          color: '#3F4591',
          width: 2
        },
        name:"",
      };      
      
      var axis_template ={
        showgrid: true,
        zeroline: true,
        nticks: 23,
        range: [-11,11], 
        gridcolor: '#bdbdbd', //grid color
        gridwidth: 1.2, //grid width
        zerolinecolor: 'black', // axes color
        zerolinewidth: 1.5, // axes widths
        showticklabels:false
      };

      var axisMarkers =   {
        x: [-0.25,10.75],
        y: [10.75,-0.25],
        mode: 'text',
        text:["y","x"],
        textposition:["left","bottom"],
        textfont: {
          size:18,
        },
        hoverinfo:'none'
      };

      // make grid smaller for mobile
      var gridsize;
      var indent;
      // gridsize= Math.min(.95*window.innerWidth,550);
      
      if(window.innerWidth > 601){
         gridsize = 550;
         indent = 20;
      }else{
         gridsize = 350;
         indent = 0;
      }
      
      var xTickMarkLabels =   {
        x: [-10.1,-9.1,-8.1,-7.1,-6.1,-5.1,-4.1,-3.1,-2.1,-1.1,0,1,2,3,4,5,6,7,8,9,10],
        y: [-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1],
        mode: 'text',
        text:[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10],
        textposition:"bottom",
        textfont: {
          size:13,
        },
        hoverinfo:'none'
      };   
      
      var yTickMarkLabels =   {
        y: [-10.1,-9.1,-8.1,-7.1,-6.1,-5.1,-4.1,-3.1,-2.1,-1.1,0,1,2,3,4,5,6,7,8,9,10],
        x: [-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1],
        mode: 'text',
        text:[-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10],
        textposition:"left",
        textfont: {
          size:13,
        },
        hoverinfo:'none'
      };
      
      var layout = {
        xaxis:axis_template,
        yaxis:axis_template,
        showlegend: false,
        width: gridsize,
        height: gridsize,
        hovermode: 'closest',   
        font:{size: 18},
        margin: {l: indent,  r: 30, t: 20}
      };
      
      layout.annotations= [
      {
         x: 0,
         y: 11,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: 0,
         ay: 35
       },
       {
         x: 0,
         y: -11,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: 0,
         ay: -35
       },
       {
         x: 11,
         y: 0,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: -35,
         ay: 0
       },
       {
         x: -11,
         y: 0,
         showarrow: true,
         arrowsize:2,
         arrowwidth:1,
         arrowhead:3,
         ax: 35,
         ay: 0
       }

     ];
      
      var data = [trace1,trace2,xTickMarkLabels,yTickMarkLabels,axisMarkers];
      Plotly.newPlot('plot', data, layout,{displayModeBar: false});
    }
    catch (err) {
      console.error(err)
      alert(err)
    }
  }

function getMaxAndMin(func,xmin,xmax){

var expr = math.compile(func); 
// evaluate the expression repeatedly for different values of x
var xValues = math.range(xmin, xmax, 0.1).toArray();
      
for(var i = 0; i < xValues.length-1; i ++){ 
   xValues[i] = Math.round(xValues[i]*100)/100;
}
      
      const yValues = xValues.map(function (x) {
        return expr.eval({x: x});
      });
var maxValue = -100;
var minValue = 100;

for (let i = 0; i < xValues.length; i++) {
    const y = yValues[i];

    if (y > maxValue) {
        maxValue = y;
    }
    if (y < minValue){
        minValue = y;
    }
}
  return {min: Math.round(minValue*10)/10, max: Math.round(maxValue*10)/10};
 
}

  function createInterval(min,incMin,max,incMax,variable){
    var output = "";
    var firstSymb = "";
    var secondSym = "";

    switch(random(0,1)){
      // interval
      case 0:
        if(incMin){ output += "\[";  } else { output += "\("; }
        output += `${min},${max}`;
        if(incMax){ output += "\]"; } else { output += "\)"; }
      break;

      inequality
      case 1:
        output += `${min}`;
        if(incMin){ output += "\\leq";  } else { output += "<"; }
        output += ` ${variable} `;
        if(incMax){ output += "\\leq"; } else { output += "<"; }
        output += `${max}`;
      break;

    }
    return output;
  }

  function quinticWithExtremaPretty(xs, ys) {
  const [x0, x1, x2, x3] = xs;
  const [y0, y1, y2, y3] = ys;

  const A = [
    [x0**5, x0**4, x0**3, x0**2, x0, 1],    // f(x0) = y0
    [x1**5, x1**4, x1**3, x1**2, x1, 1],    // f(x1) = y1
    [5*x1**4, 4*x1**3, 3*x1**2, 2*x1, 1, 0],// f'(x1) = 0
    [x2**5, x2**4, x2**3, x2**2, x2, 1],    // f(x2) = y2
    [5*x2**4, 4*x2**3, 3*x2**2, 2*x2, 1, 0],// f'(x2) = 0
    [x3**5, x3**4, x3**3, x3**2, x3, 1]     // f(x3) = y3
  ];
  const B = [y0, y1, 0, y2, 0, y3];

  // Gaussian elimination
  function solve(A, B) {
    const n = A.length;
    const M = A.map((row, i) => [...row, B[i]]);
    for (let i = 0; i < n; i++) {
      let maxRow = i;
      for (let k = i+1; k < n; k++) {
        if (Math.abs(M[k][i]) > Math.abs(M[maxRow][i])) maxRow = k;
      }
      [M[i], M[maxRow]] = [M[maxRow], M[i]];
      let div = M[i][i];
      if (Math.abs(div) < 1e-12) throw new Error("No unique solution");
      for (let j = i; j <= n; j++) M[i][j] /= div;
      for (let k = 0; k < n; k++) {
        if (k === i) continue;
        let factor = M[k][i];
        for (let j = i; j <= n; j++) M[k][j] -= factor * M[i][j];
      }
    }
    return M.map(row => row[n]);
  }

  const coeffs = solve(A, B);

  // Pretty-print polynomial
  function prettyPrint(coeffs) {
    const vars = ["x^5", "x^4", "x^3", "x^2", "x", ""];
    let parts = [];
    coeffs.forEach((c, i) => {
      if (Math.abs(c) < 1e-10) return; // skip ~0
      const coeff = Math.round(c * 1e6) / 1e6; // round
      const sign = coeff >= 0 ? (parts.length ? " + " : "") : " - ";
      const absCoeff = Math.abs(coeff);
      if (vars[i] === "") {
        parts.push(sign + absCoeff);
      } else if (absCoeff === 1) {
        parts.push(sign + vars[i]);
      } else {
        parts.push(sign + absCoeff + vars[i].replace("^1", ""));
      }
    });
    return parts.join("");
  }

  return prettyPrint(coeffs);
}

  function isNumber(n){
    return typeof n == 'number' && !isNaN(n) && isFinite(n);
 }
</script>